<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.5293f0e00c92128969df.css" data-identity="gatsby-global-css">.main-banner{background:url(/static/main_img_mobile-2841f254ae2fa914a2b023058ec34a40.jpeg);background-attachment:fixed;background-position:50%;background-repeat:no-repeat;background-size:cover;position:relative}@media (min-width:1024px){.main-banner{background:url(/static/main_img-eeadbed90e9e217b1294abb9f86d0988.jpg)}}.main-banner .subtitle,.main-banner .title{color:#fff}.main-banner-shade{background:rgba(0,0,0,.3);bottom:0;left:0;position:absolute;right:0;top:0}</style><meta name="generator" content="Gatsby 4.0.2"/><script>window.dataLayer = window.dataLayer || [];window.dataLayer.push({"platform":"gatsby"}); (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl+'';f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer', 'G-JTRSG8L60Z');</script><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true"></title><link data-react-helmet="true" rel="icon" href="/favicon.ico"/><link data-react-helmet="true" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link as="script" rel="preload" href="/webpack-runtime-e8d09e65819584e4a4bb.js"/><link as="script" rel="preload" href="/framework-b755398cc8fa0d117e92.js"/><link as="script" rel="preload" href="/app-424ac0eb0fd6662108c3.js"/><link as="script" rel="preload" href="/2c3559a924fb44b3f652ff5b708b64a3c6f77a42-1062a5ec4f87343c995d.js"/><link as="script" rel="preload" href="/component---src-pages-blog-mdx-slug-js-2d98bb37e10054a690e0.js"/><link as="fetch" rel="preload" href="/page-data/blog/post18/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=G-JTRSG8L60Z" height="0" width="0" style="display: none; visibility: hidden" aria-hidden="true"></iframe></noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><nav class="navbar is-light" role="navigation" aria-label="main navigation"><div class="container is-max-desktop"><div class="navbar-brand"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/projects">Projects</a><a class="navbar-item" href="/blog">Blog</a><a class="navbar-item" href="/cv">CV</a></div></div></nav><section class="hero is-medium main-banner"><div class="main-banner-shade"></div><div class="hero-body"><div class="container is-max-desktop"><h1 class="title">Temporary table</h1><p class="subtitle is-6">Posted on <time dateTime="October 8, 2021">October 8, 2021</time></p></div></div></section><section class="section"><div class="container is-max-desktop"><article class="content"><p>A <strong>temporary table</strong> stores data within the database session, in which it was created. When the session is ended, the dataset is automatically deleted. We are using a temporary table when we need to use some specific data for several SQL queries within one session. They can collect the results of multiple, separate queries or store a filtered subset of the database. You don’t need to select and filter the data each time you work with it. Using temporary tables simplifies our SQL queries and makes them easier to understand for others.
There are different ways to create temporary tables, like clauses WITH … AS, SELECT… INTO, CREATE TEMP TABLE.
The syntax is as follow:</p><pre><code>WITH new_table_name AS(
SELECT col_name1
FROM table_name)

SELECT *
INTO new_table_name
FROM table_name
WHERE col_name = “Germany”

CREATE TEMP TABLE new_table_name AS
(
SELECT *
FROM table_name
WHERE col_name = “Germany”
)
</code></pre><p>Within a session temporary table works like a normal table, you can perform the operations SELECT, INSERT, DELETE with it. After the session ended, the tables, that were made with SELECT... INTO and WITH...AS statements are automatically deleted.
The temporary table that was created with CREATE TABLE statement is added to the database and it is the user’s responsibility to delete or drop it. In that case, using <strong>DROP</strong> table_name will delete not only the rows of the table but also columns and table definition. Using <strong>DELETE</strong> table_name statement will delete only rows, but leaves the columns of the table to be used again.</p><p>I prefer using WITH … AS statement.
For example, returning to our open public dataset. Let’s now use the  ‘san_francisko_bikeshare’ dataset. With a temporary table ‘popular_bike’ I will find the most popular bike and what is its starting station.  Then in my next query, I will join another table to my temporary table and will find how many bikes are available on this starting_station. It is for the reason, to find if this bike is popular only because there is a lack of them on this station or it is just a popular starting point.</p><pre><code>WITH popular_bike AS (
   SELECT bike_number,
       start_station_id,
       (SUM (duration_sec)/3600) AS duration_of_use   --to find the time in hours we will delete duration on 3600
   FROM `bigquery-public-data.san_francisco_bikeshare.bikeshare_trips`
   GROUP BY bike_number, start_station_id
   ORDER BY duration_of_use DESC
   LIMIT 1)

SELECT a.bike_number,
   a.duration_of_use,
   b.station_id,
   b.num_bikes_available
FROM popular_bike a LEFT JOIN  `bigquery-public-data.san_francisco_bikeshare.bikeshare_station_status` b
ON a.start_station_id = b.station_id
</code></pre><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <a class="gatsby-resp-image-link" href="/static/12031583bcf2424eff8c8df338bc921b/7ef4c/sf_bikeshare_avg.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:41.891891891891895%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABHUlEQVQoz5WSW2ocMRBFe/lZiDfkn/wYbDweumd6+jHqh0qlknSM2kkgwcH4wqEkELdU3Gp+Pjt+PJx4fHJs3tCY2MQYnaLRcKsyuUCM8S80RoZl4n6/M8/zwbIsNCIe1cjqE7fbyK3vuV4u3N1KfxvZt42qUgoUflE+7p+o8d6zizHtykvbcereOLVvdOPAa9dxnXokKVv0eAvsMSCmf5r8SyMiiASCBjIZywVNBbVMKplgGVFDNGIpYTmRcv7U7DCsc/d9zzAMlJyRkJiWiFsjool5NeYlsksiV6Ocj/o/mpQSqkr9qRdBNaDhg/rgu2pqSufzGeccl1Fou/4IpusuR4K1mZkRox31K5pq1LbtMXY9/6auwbEeqt/iHWHzbmWXXjuGAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="Bikeshare_temporary table" title="Bikeshare_temporary table" src="/static/12031583bcf2424eff8c8df338bc921b/fcda8/sf_bikeshare_avg.png" srcSet="/static/12031583bcf2424eff8c8df338bc921b/12f09/sf_bikeshare_avg.png 148w,/static/12031583bcf2424eff8c8df338bc921b/e4a3f/sf_bikeshare_avg.png 295w,/static/12031583bcf2424eff8c8df338bc921b/fcda8/sf_bikeshare_avg.png 590w,/static/12031583bcf2424eff8c8df338bc921b/efc66/sf_bikeshare_avg.png 885w,/static/12031583bcf2424eff8c8df338bc921b/c83ae/sf_bikeshare_avg.png 1180w,/static/12031583bcf2424eff8c8df338bc921b/7ef4c/sf_bikeshare_avg.png 1748w" sizes="(max-width: 590px) 100vw, 590px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p><p>This result tells us that the most popular bike Num.535 has been rented for 4805 hours. It lives on the station with Id.66 and the number of bikes available there is 25. Is it a lot? Or is it not enough? To answer this question we need to know the number of bikes on other stations. So I have found an average, minimum and maximum number of bikes for all the stations.</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <a class="gatsby-resp-image-link" href="/static/12031583bcf2424eff8c8df338bc921b/7ef4c/sf_bikeshare_avg.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:41.891891891891895%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABHUlEQVQoz5WSW2ocMRBFe/lZiDfkn/wYbDweumd6+jHqh0qlknSM2kkgwcH4wqEkELdU3Gp+Pjt+PJx4fHJs3tCY2MQYnaLRcKsyuUCM8S80RoZl4n6/M8/zwbIsNCIe1cjqE7fbyK3vuV4u3N1KfxvZt42qUgoUflE+7p+o8d6zizHtykvbcereOLVvdOPAa9dxnXokKVv0eAvsMSCmf5r8SyMiiASCBjIZywVNBbVMKplgGVFDNGIpYTmRcv7U7DCsc/d9zzAMlJyRkJiWiFsjool5NeYlsksiV6Ocj/o/mpQSqkr9qRdBNaDhg/rgu2pqSufzGeccl1Fou/4IpusuR4K1mZkRox31K5pq1LbtMXY9/6auwbEeqt/iHWHzbmWXXjuGAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="Bikeshare_trips avg" title="Bikeshare_trips avg" src="/static/12031583bcf2424eff8c8df338bc921b/fcda8/sf_bikeshare_avg.png" srcSet="/static/12031583bcf2424eff8c8df338bc921b/12f09/sf_bikeshare_avg.png 148w,/static/12031583bcf2424eff8c8df338bc921b/e4a3f/sf_bikeshare_avg.png 295w,/static/12031583bcf2424eff8c8df338bc921b/fcda8/sf_bikeshare_avg.png 590w,/static/12031583bcf2424eff8c8df338bc921b/efc66/sf_bikeshare_avg.png 885w,/static/12031583bcf2424eff8c8df338bc921b/c83ae/sf_bikeshare_avg.png 1180w,/static/12031583bcf2424eff8c8df338bc921b/7ef4c/sf_bikeshare_avg.png 1748w" sizes="(max-width: 590px) 100vw, 590px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p><p>With this data, we can definitely say that 25 bikes it’s well over average and most probably this station is the popular starting point.</p></article></div></section><footer class="footer"><div class="content has-text-centered"><p><strong>Maryna Demchenko&#x27;s</strong> website. I use this website to share my experience of becoming a data analyst.</p><p>Copyright © 2021</p><p>This website is built with <a target="_blank" href="https://www.gatsbyjs.com/">GatsbyJS</a> and <a target="_blank" href="https://bulma.io/">Bulma</a></p></div></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/post18/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-592a7c3ce8e7b84d5c8b.js"],"app":["/app-424ac0eb0fd6662108c3.js"],"component---src-pages-404-js":["/component---src-pages-404-js-a7e17e1ee111fca70ee9.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-d93ff26dd0ddc58d0316.js"],"component---src-pages-blog-mdx-slug-js":["/component---src-pages-blog-mdx-slug-js-2d98bb37e10054a690e0.js"],"component---src-pages-cv-js":["/component---src-pages-cv-js-f37b96c3eac8c8fd5d2c.js"],"component---src-pages-index-js":["/component---src-pages-index-js-c72f5eed0e4d90ba415d.js"],"component---src-pages-projects-js":["/component---src-pages-projects-js-acabcdfa11265847c235.js"]};/*]]>*/</script><script src="/polyfill-592a7c3ce8e7b84d5c8b.js" nomodule=""></script><script src="/component---src-pages-blog-mdx-slug-js-2d98bb37e10054a690e0.js" async=""></script><script src="/2c3559a924fb44b3f652ff5b708b64a3c6f77a42-1062a5ec4f87343c995d.js" async=""></script><script src="/app-424ac0eb0fd6662108c3.js" async=""></script><script src="/framework-b755398cc8fa0d117e92.js" async=""></script><script src="/webpack-runtime-e8d09e65819584e4a4bb.js" async=""></script></body></html>