<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.5293f0e00c92128969df.css" data-identity="gatsby-global-css">.main-banner{background:url(/static/main_img_mobile-2841f254ae2fa914a2b023058ec34a40.jpeg);background-attachment:fixed;background-position:50%;background-repeat:no-repeat;background-size:cover;position:relative}@media (min-width:1024px){.main-banner{background:url(/static/main_img-eeadbed90e9e217b1294abb9f86d0988.jpg)}}.main-banner .subtitle,.main-banner .title{color:#fff}.main-banner-shade{background:rgba(0,0,0,.3);bottom:0;left:0;position:absolute;right:0;top:0}</style><meta name="generator" content="Gatsby 4.0.2"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><title data-react-helmet="true"></title><link data-react-helmet="true" rel="icon" href="/favicon.ico"/><link data-react-helmet="true" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link as="script" rel="preload" href="/webpack-runtime-7bd313972ea494cd321c.js"/><link as="script" rel="preload" href="/framework-b755398cc8fa0d117e92.js"/><link as="script" rel="preload" href="/app-f59ae61a2d4e07d589df.js"/><link as="script" rel="preload" href="/2c3559a924fb44b3f652ff5b708b64a3c6f77a42-2448affc95704d69f1c4.js"/><link as="script" rel="preload" href="/component---src-pages-blog-mdx-slug-js-2d98bb37e10054a690e0.js"/><link as="fetch" rel="preload" href="/page-data/blog/post20/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><nav class="navbar is-light" role="navigation" aria-label="main navigation"><div class="container is-max-desktop"><div class="navbar-brand"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/projects">Projects</a><a class="navbar-item" href="/blog">Blog</a><a class="navbar-item" href="/cv">CV</a></div></div></nav><section class="hero is-medium main-banner"><div class="main-banner-shade"></div><div class="hero-body"><div class="container is-max-desktop"><h1 class="title">Grouping data with IF and CASE</h1><p class="subtitle is-6">Posted on <time dateTime="October 14, 2021">October 14, 2021</time></p></div></div></section><section class="section"><div class="container is-max-desktop"><article class="content"><p>There are 2 effective tools when we need to group our data or to entitle new value.</p><p><strong>IF function</strong></p><p>The IF() function returns a value if a condition is TRUE, or another value if a condition is FALSE. It generates a new column for the answer and you can assign a name to it:</p><pre><code>IF(condition, value_if_true, value_if_false) AS new_column_name
</code></pre><p>Of course, an example is with my favourite bikeshare dataset.</p><pre><code>SELECT trip_id,

  duration_minutes,

  IF (duration_minutes &gt; 30, &quot;Long&quot;, &quot;Short&quot;) AS duration

FROM `bigquery-public-data.austin_bikeshare.bikeshare_trips`

LIMIT 100
</code></pre><p>The result was:</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <a class="gatsby-resp-image-link" href="/static/0c92b4d6b5817be89c5c692ae26a84f7/a1dd2/if_funct.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:53.37837837837838%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABVElEQVQoz4WSiW6DQAxE+f+Pq0gqVUqIBOSEhPveBTLVuHKE0qRdyRhY77M9awcAiqJAmqZit9sN0zii7mZEmYUdAWsN4jjGyP91LXFZliFJEuR5juVyrLUCZMBPUApjBsTZgC+/Rl4ZDH0n/4dhQFmWEqdn6JlIzdlsNlKV53mS8X6/o21brNaf+HDX2G49uK6LKIpwOp3knd4Yg77vxRiv5vBRVRV2ux32+z0Oh4O01XUduraRA2VZCZCtns9n2WNnr8yZ51kOBUEgQPqmaUQPVss1TdNDkuv1Cp6hcV/f1URDZlQgjVUvg6mNasbLYYJn0C+g7/sCo6cEr4C8UVZI4Duoo+IuK2TLCqRnUsJ4aZfL5f8KCQzDUGDH41G+l0AmJYzTwJbfwR4VUjOOD2+aLXPWuBTIlqkfb5hT8CeQwYRyVNgq4fxWndR03qj3897SvgFjpk9IdVj70QAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="If function result" title="If function result" src="/static/0c92b4d6b5817be89c5c692ae26a84f7/fcda8/if_funct.png" srcSet="/static/0c92b4d6b5817be89c5c692ae26a84f7/12f09/if_funct.png 148w,/static/0c92b4d6b5817be89c5c692ae26a84f7/e4a3f/if_funct.png 295w,/static/0c92b4d6b5817be89c5c692ae26a84f7/fcda8/if_funct.png 590w,/static/0c92b4d6b5817be89c5c692ae26a84f7/a1dd2/if_funct.png 838w" sizes="(max-width: 590px) 100vw, 590px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p><p><strong>CASE statement</strong></p><p>CASE returns records with your conditions by allowing you to include if/then statements in your query. It can be used in SELECT, INSERT, DELETE, and UPDATE statements and is another perfect tool for grouping data and entitling new values.</p><p>For example, let’s group our bikes according to the time they have been rented out, to low, medium, and high popularity. In that way, we will know how many of them need to be repaired, so we can plan our budget. We set the conditions for grouping and name the new column where the new data will be recorded.</p><pre><code>SELECT DISTINCT bikeid,

  COUNT(duration_minutes) AS trip_duration,

  CASE

    WHEN COUNT(duration_minutes) &lt;= 1000 THEN &quot;low&quot;

    WHEN COUNT(duration_minutes) &gt; 1000 AND COUNT(duration_minutes) &lt; 2500 THEN &quot;medium&quot;

    ELSE &quot;high&quot;

    END AS popularity

FROM `bigquery-public-data.austin_bikeshare.bikeshare_trips`

GROUP BY bikeid
</code></pre><p>The result is as follow,</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <a class="gatsby-resp-image-link" href="/static/a2c0647528fe7ae675ace33715087d1c/d67ca/case_result.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:70.27027027027026%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABpUlEQVQ4y3WTi46qQBBE+f/fu9loBHEFH4CAqCBPrZvTyRiywU6amcyjuqp68CTp+XzqfD7rer3qcrnodDqpKAqVZaGyyJVlieI4+uwfj0dlWWbJ2Wma5MLjw0JVVZa3280udl2rfphUPQbdm1HjNKltW+V5oWEYjMT9fres69rudl0n7/V62YE0TQ2IMUlS9X2nfpJ+9r3+hY1Vb9unMeI8hZmjDKb7/d7ue77vGwhS1uu1HeRQHMfa+L5+1oHSS6VtGCoIfEVRZOxg0/f9JyliDDmQJInlarUy71ijEBlFv6rrh82DIFAYhmqaxkCX0sMXwjVjHniz2WzMp8PhoO12a3NswnfGv2mA7/fbTM3z3BbHcbQRJnQUYGwpy9JkfQMzQDwj3BMg2CCQD8PH42HsnBoAIbGUBsiE6rBwclhDHn4CyAhj1p2CRYbIcYD46CSzBpCTzIjpbp+iS/mR7DxckgxTOuwks/9VsmPo/pC5ZPZ4k+7XRAHzb+yMIdUJ2PEWAXL/JgVohusy83nRRQ/xjuACLOaASN7tdiaZhz3v8rem/AeaMTT1im4MzQAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="case statement result" title="case statement result" src="/static/a2c0647528fe7ae675ace33715087d1c/fcda8/case_result.png" srcSet="/static/a2c0647528fe7ae675ace33715087d1c/12f09/case_result.png 148w,/static/a2c0647528fe7ae675ace33715087d1c/e4a3f/case_result.png 295w,/static/a2c0647528fe7ae675ace33715087d1c/fcda8/case_result.png 590w,/static/a2c0647528fe7ae675ace33715087d1c/d67ca/case_result.png 714w" sizes="(max-width: 590px) 100vw, 590px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p><p>we grouped our bikes, but so far it didn’t give us any new information. Now we need to count the number of bikes in each group, for this, we will use our previous query as a subquery.</p><pre><code>SELECT popularity,

  COUNT(bikeid) AS bikes_number

FROM

  (SELECT DISTINCT bikeid,

  COUNT(duration_minutes) AS trip_duration,

  CASE

    WHEN COUNT(duration_minutes) &lt;= 1000 THEN &quot;low&quot;

    WHEN COUNT(duration_minutes) &gt; 1000 AND COUNT(duration_minutes) &lt; 2500 THEN &quot;medium&quot;

    ELSE &quot;high&quot;

    END AS popularity

    FROM `bigquery-public-data.austin_bikeshare.bikeshare_trips`

    GROUP BY bikeid)

GROUP BY popularity
</code></pre><p>And, finally, the result gives us the information we needed, so we definitely need to plan money in our budget for check-ups and maybe some repair work for at least 286 bikes.</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <a class="gatsby-resp-image-link" href="/static/b60715fc53f34833edf7f2f8f873eb63/57dc1/case_subquery.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:45.94594594594595%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABHElEQVQoz3VSCW6DMBD0/1/XVmpTCBAB5QgOkHKfnmpWctVGZKWRV2vvMbNW67rCGINxHNE0zS++mwbG7OinHXW7ohs20O73u+CZqX3fxWERrTXKssTtdkOSpgAMysbgxRvxpTdpXGiNoijEZ+4jFCc7nU6oqgpJksDzPDiOIw1cx8HZ8/Hxecbr27s0W5YF0zSh7/tDqHmecblcZKo4jqWg7/uo6xphGAqiKEQQBBLjAEwchuEQihoStOv1Ctd15Xy0PM/RdZ34pPtUQ1Jgx23bRBtLyzZinEjTFG3bSjEbO4JQtg+jKJLF0FjMCm3vqDONiUcLkaVQYFuQU1AHm8SY3WaWZf8oP4OyW2MS/xdFp/9IhcX49ujuL+UfRHC5H8GCr+MAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="case subquery result" title="case subquery result" src="/static/b60715fc53f34833edf7f2f8f873eb63/fcda8/case_subquery.png" srcSet="/static/b60715fc53f34833edf7f2f8f873eb63/12f09/case_subquery.png 148w,/static/b60715fc53f34833edf7f2f8f873eb63/e4a3f/case_subquery.png 295w,/static/b60715fc53f34833edf7f2f8f873eb63/fcda8/case_subquery.png 590w,/static/b60715fc53f34833edf7f2f8f873eb63/57dc1/case_subquery.png 718w" sizes="(max-width: 590px) 100vw, 590px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p></article></div></section><footer class="footer"><div class="content has-text-centered"><p><strong>Maryna Demchenko&#x27;s</strong> website. I use this website to share my experience of becoming a data analyst.</p><p>The website content is licensed <a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY NC SA 4.0</a>.</p><p>This website is buils using <a target="_blank" href="https://www.gatsbyjs.com/">GatsbyJS</a> and <a target="_blank" href="https://bulma.io/">Bulma</a></p></div></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'GA_ID', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/post20/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-592a7c3ce8e7b84d5c8b.js"],"app":["/app-f59ae61a2d4e07d589df.js"],"component---src-pages-404-js":["/component---src-pages-404-js-a7e17e1ee111fca70ee9.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-d93ff26dd0ddc58d0316.js"],"component---src-pages-blog-mdx-slug-js":["/component---src-pages-blog-mdx-slug-js-2d98bb37e10054a690e0.js"],"component---src-pages-cv-js":["/component---src-pages-cv-js-f37b96c3eac8c8fd5d2c.js"],"component---src-pages-index-js":["/component---src-pages-index-js-ee17e26e2f9df7999a04.js"],"component---src-pages-projects-js":["/component---src-pages-projects-js-acabcdfa11265847c235.js"]};/*]]>*/</script><script src="/polyfill-592a7c3ce8e7b84d5c8b.js" nomodule=""></script><script src="/component---src-pages-blog-mdx-slug-js-2d98bb37e10054a690e0.js" async=""></script><script src="/2c3559a924fb44b3f652ff5b708b64a3c6f77a42-2448affc95704d69f1c4.js" async=""></script><script src="/app-f59ae61a2d4e07d589df.js" async=""></script><script src="/framework-b755398cc8fa0d117e92.js" async=""></script><script src="/webpack-runtime-7bd313972ea494cd321c.js" async=""></script></body></html>