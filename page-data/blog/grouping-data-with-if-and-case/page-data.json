{"componentChunkName":"component---src-pages-blog-mdx-slug-js","path":"/blog/grouping-data-with-if-and-case/","result":{"data":{"mdx":{"frontmatter":{"title":"Grouping data with IF and CASE","date":"October 14, 2021"},"body":"var _excluded = [\"components\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var s = Object.getOwnPropertySymbols(e); for (r = 0; r < s.length; r++) o = s[r], t.includes(o) || {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (e.includes(n)) continue; t[n] = r[n]; } return t; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"Grouping data with IF and CASE\",\n  \"date\": \"2021-10-14\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"There are 2 effective tools when we need to group our data or to entitle new value.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"IF function\")), mdx(\"p\", null, \"The IF() function returns a value if a condition is TRUE, or another value if a condition is FALSE. It generates a new column for the answer and you can assign a name to it:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"IF(condition, value_if_true, value_if_false) AS new_column_name\\n\")), mdx(\"p\", null, \"Of course, an example is with my favourite bikeshare dataset.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"SELECT trip_id,\\n  duration_minutes,\\n  IF (duration_minutes > 30, \\\"Long\\\", \\\"Short\\\") AS duration\\nFROM `bigquery-public-data.austin_bikeshare.bikeshare_trips`\\nLIMIT 100\\n\")), mdx(\"p\", null, \"The result was:\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"590px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/0c92b4d6b5817be89c5c692ae26a84f7/a1dd2/if_funct.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"53.37837837837838%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABVElEQVQoz4WSiW6DQAxE+f+Pq0gqVUqIBOSEhPveBTLVuHKE0qRdyRhY77M9awcAiqJAmqZit9sN0zii7mZEmYUdAWsN4jjGyP91LXFZliFJEuR5juVyrLUCZMBPUApjBsTZgC+/Rl4ZDH0n/4dhQFmWEqdn6JlIzdlsNlKV53mS8X6/o21brNaf+HDX2G49uK6LKIpwOp3knd4Yg77vxRiv5vBRVRV2ux32+z0Oh4O01XUduraRA2VZCZCtns9n2WNnr8yZ51kOBUEgQPqmaUQPVss1TdNDkuv1Cp6hcV/f1URDZlQgjVUvg6mNasbLYYJn0C+g7/sCo6cEr4C8UVZI4Duoo+IuK2TLCqRnUsJ4aZfL5f8KCQzDUGDH41G+l0AmJYzTwJbfwR4VUjOOD2+aLXPWuBTIlqkfb5hT8CeQwYRyVNgq4fxWndR03qj3897SvgFjpk9IdVj70QAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"If function result\",\n    \"title\": \"If function result\",\n    \"src\": \"/static/0c92b4d6b5817be89c5c692ae26a84f7/fcda8/if_funct.png\",\n    \"srcSet\": [\"/static/0c92b4d6b5817be89c5c692ae26a84f7/12f09/if_funct.png 148w\", \"/static/0c92b4d6b5817be89c5c692ae26a84f7/e4a3f/if_funct.png 295w\", \"/static/0c92b4d6b5817be89c5c692ae26a84f7/fcda8/if_funct.png 590w\", \"/static/0c92b4d6b5817be89c5c692ae26a84f7/a1dd2/if_funct.png 838w\"],\n    \"sizes\": \"(max-width: 590px) 100vw, 590px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"CASE statement\")), mdx(\"p\", null, \"CASE returns records with your conditions by allowing you to include if/then statements in your query. It can be used in SELECT, INSERT, DELETE, and UPDATE statements and is another perfect tool for grouping data and entitling new values.\"), mdx(\"p\", null, \"For example, let\\u2019s group our bikes according to the time they have been rented out, to low, medium, and high popularity. In that way, we will know how many of them need to be repaired, so we can plan our budget. We set the conditions for grouping and name the new column where the new data will be recorded.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"SELECT DISTINCT bikeid,\\n  COUNT(duration_minutes) AS trip_duration,\\n  CASE\\n    WHEN COUNT(duration_minutes) <= 1000 THEN \\\"low\\\"\\n    WHEN COUNT(duration_minutes) > 1000 AND COUNT(duration_minutes) < 2500 THEN \\\"medium\\\"\\n    ELSE \\\"high\\\"\\n    END AS popularity\\nFROM `bigquery-public-data.austin_bikeshare.bikeshare_trips`\\nGROUP BY bikeid\\n\")), mdx(\"p\", null, \"The result is as follow,\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"590px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/a2c0647528fe7ae675ace33715087d1c/d67ca/case_result.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"70.27027027027026%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABpUlEQVQ4y3WTi46qQBBE+f/fu9loBHEFH4CAqCBPrZvTyRiywU6amcyjuqp68CTp+XzqfD7rer3qcrnodDqpKAqVZaGyyJVlieI4+uwfj0dlWWbJ2Wma5MLjw0JVVZa3280udl2rfphUPQbdm1HjNKltW+V5oWEYjMT9fres69rudl0n7/V62YE0TQ2IMUlS9X2nfpJ+9r3+hY1Vb9unMeI8hZmjDKb7/d7ue77vGwhS1uu1HeRQHMfa+L5+1oHSS6VtGCoIfEVRZOxg0/f9JyliDDmQJInlarUy71ijEBlFv6rrh82DIFAYhmqaxkCX0sMXwjVjHniz2WzMp8PhoO12a3NswnfGv2mA7/fbTM3z3BbHcbQRJnQUYGwpy9JkfQMzQDwj3BMg2CCQD8PH42HsnBoAIbGUBsiE6rBwclhDHn4CyAhj1p2CRYbIcYD46CSzBpCTzIjpbp+iS/mR7DxckgxTOuwks/9VsmPo/pC5ZPZ4k+7XRAHzb+yMIdUJ2PEWAXL/JgVohusy83nRRQ/xjuACLOaASN7tdiaZhz3v8rem/AeaMTT1im4MzQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"case statement result\",\n    \"title\": \"case statement result\",\n    \"src\": \"/static/a2c0647528fe7ae675ace33715087d1c/fcda8/case_result.png\",\n    \"srcSet\": [\"/static/a2c0647528fe7ae675ace33715087d1c/12f09/case_result.png 148w\", \"/static/a2c0647528fe7ae675ace33715087d1c/e4a3f/case_result.png 295w\", \"/static/a2c0647528fe7ae675ace33715087d1c/fcda8/case_result.png 590w\", \"/static/a2c0647528fe7ae675ace33715087d1c/d67ca/case_result.png 714w\"],\n    \"sizes\": \"(max-width: 590px) 100vw, 590px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"we grouped our bikes, but so far it didn\\u2019t give us any new information. Now we need to count the number of bikes in each group, for this, we will use our previous query as a subquery.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"SELECT popularity,\\n  COUNT(bikeid) AS bikes_number\\nFROM\\n  (SELECT DISTINCT bikeid,\\n  COUNT(duration_minutes) AS trip_duration,\\n  CASE\\n    WHEN COUNT(duration_minutes) <= 1000 THEN \\\"low\\\"\\n    WHEN COUNT(duration_minutes) > 1000 AND COUNT(duration_minutes) < 2500 THEN \\\"medium\\\"\\n    ELSE \\\"high\\\"\\n    END AS popularity\\n    FROM `bigquery-public-data.austin_bikeshare.bikeshare_trips`\\n    GROUP BY bikeid)\\nGROUP BY popularity\\n\")), mdx(\"p\", null, \"And, finally, the result gives us the information we needed, so we definitely need to plan money in our budget for check-ups and maybe some repair work for at least 286 bikes.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"590px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/b60715fc53f34833edf7f2f8f873eb63/57dc1/case_subquery.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"45.94594594594595%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABHElEQVQoz3VSCW6DMBD0/1/XVmpTCBAB5QgOkHKfnmpWctVGZKWRV2vvMbNW67rCGINxHNE0zS++mwbG7OinHXW7ohs20O73u+CZqX3fxWERrTXKssTtdkOSpgAMysbgxRvxpTdpXGiNoijEZ+4jFCc7nU6oqgpJksDzPDiOIw1cx8HZ8/Hxecbr27s0W5YF0zSh7/tDqHmecblcZKo4jqWg7/uo6xphGAqiKEQQBBLjAEwchuEQihoStOv1Ctd15Xy0PM/RdZ34pPtUQ1Jgx23bRBtLyzZinEjTFG3bSjEbO4JQtg+jKJLF0FjMCm3vqDONiUcLkaVQYFuQU1AHm8SY3WaWZf8oP4OyW2MS/xdFp/9IhcX49ujuL+UfRHC5H8GCr+MAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"case subquery result\",\n    \"title\": \"case subquery result\",\n    \"src\": \"/static/b60715fc53f34833edf7f2f8f873eb63/fcda8/case_subquery.png\",\n    \"srcSet\": [\"/static/b60715fc53f34833edf7f2f8f873eb63/12f09/case_subquery.png 148w\", \"/static/b60715fc53f34833edf7f2f8f873eb63/e4a3f/case_subquery.png 295w\", \"/static/b60715fc53f34833edf7f2f8f873eb63/fcda8/case_subquery.png 590w\", \"/static/b60715fc53f34833edf7f2f8f873eb63/57dc1/case_subquery.png 718w\"],\n    \"sizes\": \"(max-width: 590px) 100vw, 590px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"67fa624a-cbcc-50b5-a6a8-90c500b4396a","slug":"grouping-data-with-if-and-case","__params":{"slug":"grouping-data-with-if-and-case"}}},"staticQueryHashes":[]}