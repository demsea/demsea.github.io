{
    "componentChunkName": "component---src-pages-blog-mdx-slug-js",
    "path": "/blog/subqueries-and-join-functions/",
    "result": {"data":{"mdx":{"frontmatter":{"title":"Subqueries and JOIN functions","date":"October 5, 2021"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Subqueries and JOIN functions\",\n  \"date\": \"2021-10-05\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Subquery\"), \" is a statement that appears inside another query statement. It is also called an inner or nested query. The inner query executes first, then the result is passed to the outer query to work with. The subquery can only have 1 column specified in the SELECT statement. We can write subquery after SELECT, FROM, or WHERE in the outer query.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"SELECT product,\\n    (SELECT AVG(price)\\n    FROM product_price) AS price\\nFROM product_price;\\n\")), mdx(\"p\", null, \"As an example, I would like to use the public dataset again (austin_bikeshare). We have a schema like this:\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"590px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/53b76d0c600723effc5bf63016075657/0e0c4/bikeshare_schema.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"53.37837837837838%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABi0lEQVQoz32R/Y7TMBDE8/aI90C8EX8diEt7DUkTJ43d+NseNAuueuiEpZHt1e7sb+3u28uA768j+vMEHxJk1YqUC4zNCDFDH0l2YxNiKriZBOf/xH+pAHMkTGuEDwXdOGsYo6GWGbVW3O93xBjF1/mCUgEXKnIBfKzIuf5tVOBCgY9FYjznUtGdhhXaWDhrse87jDGy09h7B6UUlFokrvcd3jnE4BGe5L1HjEGAOqVmGK2Rc8a2bXDO4TgOrOsqpM55iWmtxZzxEILkp5Qe4l0Mp2kSIga4sxsNWFhKQVskpiH3FqcB1e6sfxhy0YRnErKYia2AhMuy4Ha7SUPS/2vI+o5JwzDgOKy8E8chJcdnYhPJaMaG7Wma2TvD4fKG8/kEa61QtTckeSOkaHK9XoWSYuMPCcd5w2VcYJ0TU++DJJOW79pM2YiUFD/hme6d4acvZ3z+esEwHwj+DmsPKQohPj6kkfxPXJyiez0NePnRY91uOA0bfr6tUOuOaRrR972M90zDcyP/SL8BU45UapoEKOoAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Bikeshre_trips table schema\",\n    \"title\": \"Bikeshre_trips table schema\",\n    \"src\": \"/static/53b76d0c600723effc5bf63016075657/fcda8/bikeshare_schema.png\",\n    \"srcSet\": [\"/static/53b76d0c600723effc5bf63016075657/12f09/bikeshare_schema.png 148w\", \"/static/53b76d0c600723effc5bf63016075657/e4a3f/bikeshare_schema.png 295w\", \"/static/53b76d0c600723effc5bf63016075657/fcda8/bikeshare_schema.png 590w\", \"/static/53b76d0c600723effc5bf63016075657/efc66/bikeshare_schema.png 885w\", \"/static/53b76d0c600723effc5bf63016075657/c83ae/bikeshare_schema.png 1180w\", \"/static/53b76d0c600723effc5bf63016075657/0e0c4/bikeshare_schema.png 1884w\"],\n    \"sizes\": \"(max-width: 590px) 100vw, 590px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"Let\\u2019s say we want to find the start station and the number of trips from there, but we are only interested in trips that are longer than 60 minutes. So in the subquery, we filter out all the trips that were shorter than 60 minutes and aliasing this subquery as longest_trips. After this, we can refer to it like to the independent table and count the number of trips while grouping the station id.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"590px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/5c90cee10c4102352b53f3639595690d/6c2de/bikeshare_query.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"72.2972972972973%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB6ElEQVQ4y42TSZLUMBBFfVlOw4J7sOIArNj2soGgq5nK5Vm2JVseZNnyI6SqrgCioUsRL5Qa/KX8aUVx1vLj1HJMW7JS8vOYkKQF1q4459j3M3/H/yLq9cybtwmvXn/l/V1DUU8c4gEhDdZaUjFzKicWaxHKhHiYFpbleSJrF+4+N7z7UHE49rRqoBKCum7olEKIBikHVKfJsgope3SvcduG29yl39jWjXVdiYwxsM3sbiPJa9KiJS8bkqIkrXLSMiNrGlIhyEWBNiNq7JlWw2BnpnVhXhfc7vAt8mnNs0ENDjVCJgaKsqGWkqTKabqWXnfUvSYXJVVbU3cSs1lGa4LYH4J935NlGZ8eS77Hgo/39xRFztArum7GLA72nd153KXf2ff9PH9ZuxYlz3MOhwOPhwceHr7gx8ti0ZMN5o+zZV1tKJD3yGOv2Gvs5719IeW2bVFK0TTN+WSgm3b0vDOa89hdbvUSQdDjS248ZmaeRhZjQuzxa77dJOg3DsOAlAqte/RoUXrBe+tppQwZTNPELS3yqVZVRRzHFHlGnDV8OwrGYQgHeVG/p+u64NFLBEGtdfggSVKqsiRJTmHxqQjXYlzs+R+R/wefmpTynGbbBgHvye/v9CYPe/+MLpufbuur/ZzgLfwCxHQ7fYV0yOgAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Bikeshre_trips query\",\n    \"title\": \"Bikeshre_trips query\",\n    \"src\": \"/static/5c90cee10c4102352b53f3639595690d/fcda8/bikeshare_query.png\",\n    \"srcSet\": [\"/static/5c90cee10c4102352b53f3639595690d/12f09/bikeshare_query.png 148w\", \"/static/5c90cee10c4102352b53f3639595690d/e4a3f/bikeshare_query.png 295w\", \"/static/5c90cee10c4102352b53f3639595690d/fcda8/bikeshare_query.png 590w\", \"/static/5c90cee10c4102352b53f3639595690d/efc66/bikeshare_query.png 885w\", \"/static/5c90cee10c4102352b53f3639595690d/c83ae/bikeshare_query.png 1180w\", \"/static/5c90cee10c4102352b53f3639595690d/6c2de/bikeshare_query.png 1334w\"],\n    \"sizes\": \"(max-width: 590px) 100vw, 590px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"Also, sometimes subquery is used instead of a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"JOIN\"), \" function, so with its help, we can get the data from both tables.\\nFrom the performance point of view, a subquery is executed slower than JOIN.\\nWe are using the JOIN function to join 2 or more tables. There are different types of JOIN:\\nAn \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"INNER JOIN or JOIN\"), \" is a function that returns records with matching values in both tables.\\nA \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"LEFT JOIN\"), \" is a function that will return all the records from the left table and only the matching records from the right table.\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"RIGHT JOIN\"), \" does the opposite. It will return all records from the right table and only the matching records from the left.\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"FULL OUTER JOIN\"), \" combines RIGHT and LEFT JOIN to return all records in both tables.\\nThere is also a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"CROSS JOIN\"), \" (or cartesian), it returns all rows joined from both sides.\\nFor example, if we have 2 rows in table_1 and 10 rows in table_2. Executing CROSS JOIN on both tables will give us 1 table with 20 rows without any matching.\"), mdx(\"p\", null, \"There is also self-join when you join the same table and aliasing it 2 names. Usually, it is made to find a row-dependant relationship. An example of it:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"SELECT e.LastName AS Employees, m.LastName AS Managers\\nFROM Employees e LEFT JOIN Employees m\\nON m.EmployeeId = e.ReportsTo;\\n\")), mdx(\"p\", null, \"However, it is advised to use the window function instead, as self-join can cause poor performance.\"));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"ab51aebe-dd9a-5ff5-a54d-86fec24dd952","slug":"subqueries-and-join-functions","__params":{"slug":"subqueries-and-join-functions"}}},
    "staticQueryHashes": []}